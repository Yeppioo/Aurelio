<UserControl
    d:DesignHeight="450"
    d:DesignWidth="800"
    mc:Ignorable="d"
    x:Class="Aurelio.Plugin.Minecraft.Views.FetcherPages.Vanilla.VersionSelector"
    xmlns="https://github.com/avaloniaui"
    xmlns:controls="clr-namespace:FluentAvalonia.UI.Controls;assembly=FluentAvalonia"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:properties="clr-namespace:Aurelio.Public.Langs;assembly=Aurelio"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Border Name="Root">
        <Grid>
            <!--  Loading State  -->
            <Border
                Background="Transparent"
                IsVisible="{Binding IsLoading}"
                Name="LoadingPanel">
                <StackPanel
                    HorizontalAlignment="Center"
                    Spacing="16"
                    VerticalAlignment="Center">
                    <controls:ProgressRing
                        Height="48"
                        IsIndeterminate="True"
                        Width="48" />
                    <TextBlock
                        FontSize="14"
                        HorizontalAlignment="Center"
                        Text="{Binding Source={x:Static properties:MainLangProvider.Current}, Path=Resources.Loading}" />
                </StackPanel>
            </Border>

            <!--  Error State  -->
            <Border
                Background="Transparent"
                IsVisible="{Binding HasError}"
                Name="ErrorPanel">
                <StackPanel
                    HorizontalAlignment="Center"
                    Spacing="16"
                    VerticalAlignment="Center">
                    <TextBlock
                        FontSize="16"
                        FontWeight="SemiBold"
                        HorizontalAlignment="Center"
                        Text="Failed to load Minecraft versions" />
                    <TextBlock
                        FontSize="12"
                        Foreground="Gray"
                        HorizontalAlignment="Center"
                        MaxWidth="400"
                        Text="{Binding ErrorMessage}"
                        TextWrapping="Wrap" />
                    <Button
                        Click="OnRetryClick"
                        Content="Retry"
                        HorizontalAlignment="Center"
                        Name="RetryButton" />
                </StackPanel>
            </Border>

            <!--  Main Content  -->
            <Border
                ClipToBounds="True"
                CornerRadius="10"
                IsVisible="{Binding IsContentVisible}"
                Margin="0,0,0,10">
                <ScrollViewer Name="MainContent" VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="15,10,15,15" Spacing="16">

                        <!--  Header Card with Latest Versions  -->
                        <Border
                            Background="{DynamicResource CardBackgroundBrush}"
                            BorderBrush="{DynamicResource CardBorderBrush}"
                            Padding="0">
                            <Grid ColumnDefinitions="*,16,*">

                                <!--  Latest Snapshot Card  -->
                                <Border
                                    Background="{DynamicResource CardBackgroundColor}"
                                    CornerRadius="10"
                                    Cursor="Hand"
                                    Grid.Column="0"
                                    Padding="12"
                                    PointerPressed="OnLatestSnapshotClick">
                                    <Border.Styles>
                                        <Style Selector="Border:pointerover">
                                            <Setter Property="Background" Value="{DynamicResource CardBackgroundPointerOverBrush}" />
                                        </Style>
                                    </Border.Styles>
                                    <StackPanel Spacing="8">
                                        <TextBlock
                                            FontSize="14"
                                            FontWeight="SemiBold"
                                            Text="Latest Snapshot" />
                                        <TextBlock
                                            FontSize="16"
                                            FontWeight="Bold"
                                            Text="{Binding LatestSnapshot.Id}" />
                                        <TextBlock
                                            FontSize="12"
                                            Foreground="Gray"
                                            Text="{Binding LatestSnapshot.ReleaseTime, StringFormat='yyyy-MM-dd'}" />
                                    </StackPanel>
                                </Border>

                                <!--  Latest Release Card  -->
                                <Border
                                    Background="{DynamicResource CardBackgroundColor}"
                                    CornerRadius="10"
                                    Cursor="Hand"
                                    Grid.Column="2"
                                    Padding="12"
                                    PointerPressed="OnLatestReleaseClick">
                                    <Border.Styles>
                                        <Style Selector="Border:pointerover">
                                            <Setter Property="Background" Value="{DynamicResource CardBackgroundPointerOverBrush}" />
                                        </Style>
                                    </Border.Styles>
                                    <StackPanel Spacing="8">
                                        <TextBlock
                                            FontSize="14"
                                            FontWeight="SemiBold"
                                            Text="Latest Release" />
                                        <TextBlock
                                            FontSize="16"
                                            FontWeight="Bold"
                                            Text="{Binding LatestRelease.Id}" />
                                        <TextBlock
                                            FontSize="12"
                                            Foreground="Gray"
                                            Text="{Binding LatestRelease.ReleaseTime, StringFormat='yyyy-MM-dd'}" />
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </Border>

                        <!--  All Versions Expander  -->
                        <Border Background="{DynamicResource CardBackgroundColor}" CornerRadius="{DynamicResource CardCornerRadius}">
                            <Expander
                                Classes="card"
                                Header="{Binding Source={x:Static properties:MainLangProvider.Current}, Path=Resources.AllVersion}"
                                Name="AllVersionsExpander">
                                <Border CornerRadius="6" Padding="12">
                                    <StackPanel Spacing="12">
                                        <TextBox
                                            Name="AllVersionsSearchBox"
                                            Text="{Binding AllVersionsSearchText}"
                                            Watermark="{Binding Source={x:Static properties:MainLangProvider.Current}, Path=Resources.SearchKeyword}" />
                                        <ListBox
                                            ItemsSource="{Binding FilteredAllVersions}"
                                            MaxHeight="300"
                                            Name="AllVersionsList"
                                            SelectionChanged="OnVersionSelected">
                                            <ListBox.ItemTemplate>
                                                <DataTemplate>
                                                    <Border Cursor="Hand" Padding="8,4">
                                                        <Grid ColumnDefinitions="*,Auto">
                                                            <TextBlock
                                                                Grid.Column="0"
                                                                Text="{Binding Id}"
                                                                VerticalAlignment="Center" />
                                                            <TextBlock
                                                                FontSize="12"
                                                                Foreground="Gray"
                                                                Grid.Column="1"
                                                                Text="{Binding ReleaseTime, StringFormat='yyyy-MM-dd'}"
                                                                VerticalAlignment="Center" />
                                                        </Grid>
                                                    </Border>
                                                </DataTemplate>
                                            </ListBox.ItemTemplate>
                                        </ListBox>
                                    </StackPanel>
                                </Border>
                            </Expander>
                        </Border>

                        <!--  Release Versions Expander  -->
                        <Border Background="{DynamicResource CardBackgroundColor}" CornerRadius="{DynamicResource CardCornerRadius}">
                            <Expander
                                Classes="card"
                                Header="{Binding Source={x:Static properties:MainLangProvider.Current}, Path=Resources.ReleaseVersion}"
                                IsExpanded="True"
                                Name="ReleaseVersionsExpander">
                                <Border CornerRadius="6" Padding="12">
                                    <StackPanel Spacing="12">
                                        <TextBox
                                            Name="ReleaseVersionsSearchBox"
                                            Text="{Binding ReleaseVersionsSearchText}"
                                            Watermark="{Binding Source={x:Static properties:MainLangProvider.Current}, Path=Resources.SearchKeyword}" />
                                        <ListBox
                                            ItemsSource="{Binding FilteredReleaseVersions}"
                                            MaxHeight="300"
                                            Name="ReleaseVersionsList"
                                            SelectionChanged="OnVersionSelected">
                                            <ListBox.ItemTemplate>
                                                <DataTemplate>
                                                    <Border Cursor="Hand" Padding="8,4">
                                                        <Grid ColumnDefinitions="*,Auto">
                                                            <TextBlock
                                                                Grid.Column="0"
                                                                Text="{Binding Id}"
                                                                VerticalAlignment="Center" />
                                                            <TextBlock
                                                                FontSize="12"
                                                                Foreground="Gray"
                                                                Grid.Column="1"
                                                                Text="{Binding ReleaseTime, StringFormat='yyyy-MM-dd'}"
                                                                VerticalAlignment="Center" />
                                                        </Grid>
                                                    </Border>
                                                </DataTemplate>
                                            </ListBox.ItemTemplate>
                                        </ListBox>
                                    </StackPanel>
                                </Border>
                            </Expander>
                        </Border>

                        <!--  Snapshot Versions Expander  -->
                        <Border Background="{DynamicResource CardBackgroundColor}" CornerRadius="{DynamicResource CardCornerRadius}">
                            <Expander
                                Classes="card"
                                Header="{Binding Source={x:Static properties:MainLangProvider.Current}, Path=Resources.PreviewVersion}"
                                Name="SnapshotVersionsExpander">
                                <Border
                                    Background="{DynamicResource CardBackgroundBrush}"
                                    BorderBrush="{DynamicResource CardBorderBrush}"
                                    BorderThickness="1"
                                    CornerRadius="6"
                                    Padding="12">
                                    <StackPanel Spacing="12">
                                        <TextBox
                                            Name="SnapshotVersionsSearchBox"
                                            Text="{Binding SnapshotVersionsSearchText}"
                                            Watermark="{Binding Source={x:Static properties:MainLangProvider.Current}, Path=Resources.SearchKeyword}" />
                                        <ListBox
                                            ItemsSource="{Binding FilteredSnapshotVersions}"
                                            MaxHeight="300"
                                            Name="SnapshotVersionsList"
                                            SelectionChanged="OnVersionSelected">
                                            <ListBox.ItemTemplate>
                                                <DataTemplate>
                                                    <Border Cursor="Hand" Padding="8,4">
                                                        <Grid ColumnDefinitions="*,Auto">
                                                            <TextBlock
                                                                Grid.Column="0"
                                                                Text="{Binding Id}"
                                                                VerticalAlignment="Center" />
                                                            <TextBlock
                                                                FontSize="12"
                                                                Foreground="Gray"
                                                                Grid.Column="1"
                                                                Text="{Binding ReleaseTime, StringFormat='yyyy-MM-dd'}"
                                                                VerticalAlignment="Center" />
                                                        </Grid>
                                                    </Border>
                                                </DataTemplate>
                                            </ListBox.ItemTemplate>
                                        </ListBox>
                                    </StackPanel>
                                </Border>
                            </Expander>
                        </Border>

                        <!--  Old Versions Expander  -->
                        <Border
                            Background="{DynamicResource CardBackgroundColor}"
                            Classes="card"
                            CornerRadius="{DynamicResource CardCornerRadius}">
                            <Expander Header="{Binding Source={x:Static properties:MainLangProvider.Current}, Path=Resources.OldVersion}" Name="OldVersionsExpander">
                                <Border
                                    Background="{DynamicResource CardBackgroundBrush}"
                                    BorderBrush="{DynamicResource CardBorderBrush}"
                                    BorderThickness="1"
                                    CornerRadius="6"
                                    Padding="12">
                                    <StackPanel Spacing="12">
                                        <TextBox
                                            Name="OldVersionsSearchBox"
                                            Text="{Binding OldVersionsSearchText}"
                                            Watermark="{Binding Source={x:Static properties:MainLangProvider.Current}, Path=Resources.SearchKeyword}" />
                                        <ListBox
                                            ItemsSource="{Binding FilteredOldVersions}"
                                            MaxHeight="300"
                                            Name="OldVersionsList"
                                            SelectionChanged="OnVersionSelected">
                                            <ListBox.ItemTemplate>
                                                <DataTemplate>
                                                    <Border Cursor="Hand" Padding="8,4">
                                                        <Grid ColumnDefinitions="*,Auto">
                                                            <TextBlock
                                                                Grid.Column="0"
                                                                Text="{Binding Id}"
                                                                VerticalAlignment="Center" />
                                                            <TextBlock
                                                                FontSize="12"
                                                                Foreground="Gray"
                                                                Grid.Column="1"
                                                                Text="{Binding ReleaseTime, StringFormat='yyyy-MM-dd'}"
                                                                VerticalAlignment="Center" />
                                                        </Grid>
                                                    </Border>
                                                </DataTemplate>
                                            </ListBox.ItemTemplate>
                                        </ListBox>
                                    </StackPanel>
                                </Border>
                            </Expander>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </Border>
</UserControl>
